CREATE DATABASE ELETRONICA;

USE ELETRONICA;


CREATE TABLE PESSOAL (
    IDPESSOAL INT PRIMARY KEY AUTO_INCREMENT,
    NOME VARCHAR (20) NOT NULL,
    SOBRENOME VARCHAR (30) NOT NULL,
    SEXO ENUM('M','F') NOT NULL,
    CPF VARCHAR(15) UNIQUE,
    EMAIL VARCHAR(50) UNIQUE,
    ID_USUARIO INT UNIQUE
);

CREATE TABLE USUARIO (
    IDUSUARIO INT PRIMARY KEY AUTO_INCREMENT,
    USUARIO VARCHAR(30),
    SENHA VARCHAR(30)
);


CREATE TABLE ENDERECO (
    IDENDERECO INT PRIMARY KEY AUTO_INCREMENT,
    BAIRRO VARCHAR (30) NOT NULL,
    UF INT (2) NOT NULL,
    CEP VARCHAR (20) NOT NULL,
    NUMERO INT (8) NOT NULL,
    CIDADE VARCHAR(30) NOT NULL,
    RUA VARCHAR (50) NOT NULL,
    ID_PESSOAL INT UNIQUE
);

CREATE TABLE TELEFONE(
    IDTELEFONE INT PRIMARY KEY AUTO_INCREMENT,
    DDD INT(3) NOT NULL,
    NUMERO VARCHAR(10) NOT NULL,
    ID_PESSOAL INT

);

--------------------------------Forum--------------------------------------
CREATE TABLE POST( 
    IDPOST INT PRIMARY KEY AUTO_INCREMENT,
    TITULO VARCHAR (30) NOT NULL,
    CONTEUDO TEXT,
    ID_USUARIO INT,
    TEMA ENUM('Dica','Duvida','Reclamação','Novidades') NOT NULL

);

CREATE TABLE RESPOSTA(
    IDRESPOSTA INT PRIMARY KEY AUTO_INCREMENT,
    RESP TEXT,
    ID_POST INT

);

CREATE TABLE RESPOSTA_USUARIO(
    ID_RESPOSTA INT,
    ID_USUARIO INT,
    PRIMARY KEY (ID_RESPOSTA, ID_USUARIO)
);


--------------------------Compra e Venda---------------------

CREATE TABLE PECA(
    IDPECA INT PRIMARY KEY AUTO_INCREMENT,
    PECA VARCHAR(50) NOT NULL,
    PRECO FLOAT(100,2) NOT NULL,
    ID_PESSOAL INT 

);

    CREATE TABLE MARCA(
    IDMARCA INT PRIMARY KEY AUTO_INCREMENT,
    MARCA VARCHAR(50) NOT NULL,
    ID_PECA INT

);

CREATE TABLE PEDIDOS(
    IDPEDIDOS INT PRIMARY KEY AUTO_INCREMENT,    
    CxV ENUM('Compra','Venda') NOT NULL
);

CREATE TABLE PEDIDOS_ITEM(
    IDPEDIDOS_ITEM INT PRIMARY KEY AUTO_INCREMENT,    
    QUANTIDADE INT(100) NOT NULL,
    PECA VARCHAR(50) NOT NULL,
    PRECO FLOAT(100,2) NOT NULL,
    ID_PEDIDOS
);


-- CONTRAINTS --

------------Login-------------

ALTER TABLE TELEFONE 
ADD CONSTRAINT FK_TELEFONE_PESSOAL 
FOREIGN KEY(ID_PESSOAL)
REFERENCES PESSOAL(IDPESSOAL);

ALTER TABLE PESSOAL
ADD CONSTRAINT FK_PESSOAL_USUARIO 
FOREIGN KEY(ID_USUARIO)
REFERENCES USUARIO(IDUSUARIO);

ALTER TABLE ENDERECO
ADD CONSTRAINT FK_ENDERECO_PESSOAL 
FOREIGN KEY (ID_PESSOAL)
REFERENCES PESSOAL(IDPESSOAL);


------------------Forum-------------------
ALTER TABLE POST 
ADD CONSTRAINT FK_POST_USUARIO
FOREIGN KEY(ID_USUARIO)
REFERENCES USUARIO(IDUSUARIO);

ALTER TABLE RESPOSTA
ADD CONSTRAINT FK_RESPOSTA_POST
FOREIGN KEY(ID_POST)
REFERENCES POST(IDPOST);

ALTER TABLE RESPOSTA_USUARIO
ADD CONSTRAINT FK_RESPOSTA
FOREIGN KEY(ID_RESPOSTA)
REFERENCES RESPOSTA(IDRESPOSTA);

ALTER TABLE RESPOSTA_USUARIO
ADD CONSTRAINT FK_USUARIO
FOREIGN KEY (ID_USUARIO)
REFERENCES USUARIO(IDUSUARIO);

-----------------Compra e Venda---------------------

ALTER TABLE MARCA
ADD CONSTRAINT FK_MARCA_PECA
FOREIGN KEY (ID_PECA)
REFERENCES PECA(IDPECA);

ALTER TABLE QUANTIDADE 
ADD CONSTRAINT FK_QUANTIDADE_PECA
FOREIGN KEY (ID_PECA)
REFERENCES PECA(IDPECA);

ALTER TABLE PECA_PESSOAL
ADD CONSTRAINT FK_PECA
FOREIGN KEY (ID_PESSOAL)
REFERENCES PESSOAL(IDPESSOAL);

ALTER TABLE PEDIDOS_ITEM_PEDIDOS
ADD CONSTRAINT FK_PEDIDOS
FOREIGN KEY (ID_PEDIDOS)
REFERENCES PEDIDOS(IDPEDIDOS);



